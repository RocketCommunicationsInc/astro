<!DOCTYPE html>
<html dir="ltr" lang="en">
    <head>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0"
        />
        <title>Stencil Component Starter</title>

        <link rel="preconnect" href="https://fonts.gstatic.com" />
        <link
            href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@100;300;400&family=Roboto:wght@100;300;400;500;700;900&display=swap"
            rel="stylesheet"
        />
        <script type="module" src="/build/astro-web-components.esm.js"></script>
        <script nomodule src="/build/astro-web-components.js"></script>
        <link rel="stylesheet" href="/build/astro-web-components.css" />
        <style>
            body {
                min-height: 100vh;
            }

            rux-classification-marking {
                display: flex;
                flex-direction: column;
                min-height: 100vh;

                &::part(header),
                &::part(footer) {
                    max-height: 1.5rem;
                }
            }

            main {
                flex-grow: 1;
            }

            .zoomSelector {
                display: flex;
                align-items: center;
                padding: 1rem;

                & > span {
                    margin-right: var(--spacing-2);
                }
            }
        </style>
    </head>

    <body>
        <rux-classification-marking classification="unclassified">
            <rux-global-status-bar
                app-domain="DOMAIN"
                app-state="state"
                username="username"
            >
                <rux-clock></rux-clock>
            </rux-global-status-bar>
            <main>
                <section class="zoomSelector">
                    <span>Current Zoom:</span>
                    <rux-button
                        id="sub"
                        icon-only
                        icon="zoom-out"
                        onclick="zoom(-1)"
                    ></rux-button>
                    <rux-input readonly></rux-input>
                    <rux-button
                        id="add"
                        icon-only
                        icon="zoom-in"
                        onclick="zoom(1)"
                    ></rux-button>
                    <rux-button secondary onclick="togglegrid()"
                        >Toggle Grid</rux-button
                    >
                    <rux-button
                        id="timezone"
                        secondary
                        onclick="toggleTimezone()"
                        >Toggle Timezone</rux-button
                    ><span id="currentTimezone"></span>
                </section>

                <rux-timeline
                    id="first"
                    has-played-indicator="false"
                    timezone="America/New_York"
                    start="2021-01-01T00:00:00.000Z"
                    end="2021-02-02T01:00:00.000Z"
                    playhead="2021-01-02T00:00:00.000Z"
                    interval="hour"
                    zoom="4"
                    show-grid
                >
                    <rux-track>
                        <div slot="label">Region 1</div>
                        <rux-time-region
                            start="2021-01-02T01:00:00Z"
                            end="2021-01-03T02:00:00Z"
                            status="serious"
                        >
                            Event 1.2
                        </rux-time-region>
                    </rux-track>
                    <rux-track>
                        <div slot="label">Region 2</div>
                        <rux-time-region
                            start="2021-01-10T01:00:00Z"
                            end="2021-01-12T02:00:00Z"
                            status="serious"
                        >
                            Event 1.2
                        </rux-time-region>
                    </rux-track>
                    <rux-track slot="ruler">
                        <rux-ruler show-secondary-ruler></rux-ruler>
                    </rux-track>
                </rux-timeline>
            </main>
        </rux-classification-marking>
        <script>
            const timeline = document.querySelector('rux-timeline')
            const input = document.querySelector('rux-input')
            const currenttz = document.querySelector('#currentTimezone')
            currenttz.textContent = timeline.getAttribute('timezone')

            let zoomLevel = 4
            input.value = zoomLevel
            function zoom(number) {
                zoomLevel = zoomLevel + number
                input.value = zoomLevel
                setZoomInterval(zoomLevel)
                timeline.setAttribute('zoom', zoomLevel)
            }

            const togglegrid = () => {
                timeline.toggleAttribute('show-grid')
            }

            const toggleTimezone = () => {
                const current = timeline.timezone

                const newTz =
                    current === 'America/New_York' ? 'UTC' : 'America/New_York'
                timeline.timezone = newTz
                currenttz.textContent = newTz
            }

            function setZoomInterval(zoomLevel) {
                if (zoomLevel === 1) timeline.setAttribute('interval', 'month')
                if (zoomLevel === 2) timeline.setAttribute('interval', 'week')
                if (zoomLevel === 3) timeline.setAttribute('interval', 'day')
                if (zoomLevel === 4) timeline.setAttribute('interval', 'hour')
                if (zoomLevel <= 5) timeline.setAttribute('interval', 'minute')
            }
        </script>
    </body>
</html>
